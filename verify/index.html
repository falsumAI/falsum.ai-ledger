<!doctype html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Verify — OrigoSeal</title>
<link rel="stylesheet" href="../styles.css">
</head><body>
<header class="site-header"><div class="wrap">
  <a class="brand" href="../"><span class="logo"></span><span class="brand-text">OrigoSeal Verify</span></a>
</div></header>
<main class="wrap" style="padding:20px 0">
  <h1>Verify a Receipt</h1>
  <p>Paste a <strong>receipt ID</strong> (looks like <code>os_...</code>) or pick a file and we’ll compare it to the receipt’s SHA-256. Files never leave your device.</p>
  <label>Receipt ID <input id="rid" placeholder="os_..." style="width:320px"></label>
  <button id="load">Load receipt</button>
  <pre id="meta" style="background:#0e1015;border:1px solid #20242c;border-radius:8px;padding:10px;white-space:pre-wrap"></pre>
  <h3>Drop or pick file</h3>
  <input type="file" id="file">
  <div id="result" style="margin-top:10px"></div>
</main>
<script>
async function sha256Hex(buf){const d=await crypto.subtle.digest('SHA-256',buf);return [...new Uint8Array(d)].map(b=>b.toString(16).padStart(2,'0')).join('')}
let current=null;
document.getElementById('load').onclick=async()=>{
  const id=document.getElementById('rid').value.trim();
  if(!id){alert('Enter receipt id');return;}
  const r=await fetch(`../receipts/${id}.json`).catch(()=>null);
  if(!r||!r.ok){alert('Receipt not found');return;}
  current=await r.json();
  document.getElementById('meta').textContent=JSON.stringify(current,null,2);
};
document.getElementById('file').onchange=async(e)=>{
  if(!current){alert('Load a receipt first');return;}
  const f=e.target.files[0]; if(!f) return;
  const arr=await f.arrayBuffer(); const h=await sha256Hex(arr);
  const ok = h===current.artifact.sha256;
  document.getElementById('result').innerHTML = ok
    ? '<span style="color:#22c55e;font-weight:700">PASS</span> — file matches receipt'
    : '<span style="color:#ef4444;font-weight:700">FAIL</span> — file does not match receipt';
};
</script>
</body></html>